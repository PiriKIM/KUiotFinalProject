# 📒 KUiotFinalProject 개발 로그

## 1. 프로젝트 초기 세팅 및 구조 설계

- **목표**: Flask 기반의 실시간 자세 분석 웹앱 개발 (MediaPipe + OpenCV 활용)
- **초기 구조 설계**
  - `flaskbook/` 폴더 생성, Flask 앱 기본 구조 세팅
  - 주요 폴더/파일:  
    - `__init__.py`, `models.py`, `routes.py`, `templates/`, `static/`
    - requirements.txt, README.md 등
- **기술 스택 선정**
  - 백엔드: Flask, SQLAlchemy, Flask-Login
  - 프론트엔드: Jinja2, Bootstrap(반응형), JS
  - 자세 분석: MediaPipe, OpenCV
  - DB: SQLite(개발), 확장성 고려해 SQLAlchemy ORM 사용

---

## 2. 기본 기능 구현

- **실시간 자세 분석**
  - MediaPipe, OpenCV 연동
  - 웹캠 영상 스트림 처리, 프레임별 자세 분석
  - 목/척추/어깨/골반/척추틀어짐 등 주요 부위 분석
  - 분석 결과 실시간 시각화(스켈레톤, 각도 등 표시)
- **기본 라우팅**
  - `/` : 메인 페이지
  - `/analyze` : 자세 분석 페이지
  - `/about` : 프로젝트 소개

---

## 3. 데이터베이스 및 모델 설계

- **User 모델**
  - id, username, email, password_hash 등
  - Flask-Login 연동(세션 기반 인증)
- **PostureRecord 모델**
  - id, user_id(FK), 분석 결과(점수, 등급, 부위별 결과), timestamp 등
  - User와 1:N 관계 설정
- **DB 마이그레이션/초기화 스크립트 작성**

---

## 4. 인증 및 사용자 관리 기능

- **회원가입/로그인/로그아웃**
  - `auth.py` Blueprint 분리
  - 비밀번호 해싱(werkzeug.security)
  - 세션 기반 인증, 로그인 유지
  - 회원가입/로그인/로그아웃 라우트 및 템플릿(register.html, login.html)
  - 플래시 메시지, 입력 검증, 중복 체크 등 UX 개선
- **프로필/기록/통계**
  - `/profile` : 사용자 정보, 최근 분석 결과, 통계 요약
  - `/history` : 사용자별 분석 기록 리스트
  - `/statistics` : 종합 통계(점수 분포, 등급, 부위별 통계 등)
  - 각 페이지별 템플릿(profile.html, history.html, statistics.html) 구현

---

## 5. 분석 결과 저장 및 통계 기능

- **분석 결과 DB 저장**
  - 분석 완료 시 PostureRecord에 결과 저장
  - 사용자별로 데이터 분리, 기록/통계에서만 본인 데이터 조회
- **종합 점수/등급 계산**
  - 분석 결과에서 점수/등급 산출 로직 구현
  - 통계 페이지에서 등급별 분포, 평균, 최근 추이 등 시각화
- **쿼리 최적화**
  - SQLAlchemy relationship의 lazy 옵션을 'dynamic'으로 변경
  - `.order_by()`, `.count()`, `.all()` 등 쿼리 메서드 활용
  - 쿼리 객체 반환에 맞게 코드 수정

---

## 6. 프론트엔드/UX 개선

- **반응형 UI**
  - Bootstrap 적용, 모바일/PC 모두 대응
  - 네비게이션 바, 플래시 메시지, 버튼/폼 스타일링
- **템플릿 구조화**
  - base.html(공통 레이아웃) 상속
  - 각 기능별 템플릿 분리 및 재사용
- **사용자 경험 개선**
  - 입력 검증, 에러/성공 메시지, 접근성 고려

---

## 7. 테스트 및 더미 데이터

- **테스트 데이터 생성**
  - `create_test_data.py` 스크립트로 더미 User/Record 생성
  - 기능별 정상 동작, 통계/기록/프로필 페이지 검증
- **버그 수정**
  - 쿼리 객체 관련 오류, 관계설정, 템플릿 변수 누락 등 수정
  - 세션/인증 관련 예외 처리

---

## 8. 문서화 및 팀원 공유

- **프로젝트 구조/역할 설명**
  - Directory.md, instructions.md 등으로 폴더/파일별 역할, 기술 스택, DB 구조, 주요 기능 설명
- **README.md**
  - 설치/실행 방법, 주요 기능, 확장성, 기술 스택, 사용법 등 정리
- **SQL 구조/ERD**
  - User, PostureRecord 등 테이블 구조, 관계 설명
- **웹 반응형 안내**
  - 모바일/PC 대응, 주요 UI/UX 특징, 확장성 안내

---

## 9. 주요 시행착오 및 개선점

- **SQLAlchemy relationship lazy 옵션**
  - 초기에는 기본값 사용 → 쿼리 객체 반환 필요해 'dynamic'으로 변경
- **분석 결과 저장 위치**
  - 분석 결과를 세션/메모리 대신 DB에 저장하도록 구조 변경
- **템플릿 변수/라우트 네이밍**
  - 일관성 있게 네이밍, 변수명/라우트명 통일
- **에러/예외 처리**
  - 인증/권한/입력 검증 등 예외 처리 강화

---

## 10. 향후 계획/확장성

- **소셜 로그인, 이메일 인증 등 추가**
- **분석 결과 시각화(그래프, 차트 등) 고도화**
- **AI 자세 교정 피드백, 알림 기능**
- **다국어 지원, 관리자 페이지 등**

---

# ✅ 결론

- Flask + SQLAlchemy + MediaPipe + OpenCV 기반 실시간 자세 분석 및 사용자별 기록/통계 시스템 완성
- 인증, 데이터 관리, 반응형 UI, UX 개선 등 핵심 기능 구현
- 코드/폴더 구조, 기능별 역할, 사용법, 확장성 등 문서화 및 팀원 공유 준비 완료

---

**이 개발 로그는 팀원 온보딩, 유지보수, 기능 확장, 발표자료 등 다양한 용도로 활용할 수 있습니다.  
추가로 필요한 세부 내용이나 코드/문서 샘플이 필요하면 언제든 요청해주세요!** 