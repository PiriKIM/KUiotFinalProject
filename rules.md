🎯 목적

자세 등급 분류를 위한 기준 각도(CVA)를 정량적으로 정의하기 위해, 동영상에서 프레임을 추출하고, MediaPipe로 랜드마크를 분석해 각도를 계산한 후, 자세를 10단계로 나누고 A/B/C 정성 등급을 설정하려고 합니다. 아래 작업을 순차적으로 수행할 수 있는 Python 코드들을 작성해주세요.

🧩 1. 자세 변화 동영상 촬영 코드

웹캠을 이용해 사용자가 1단계부터 10단계까지 점진적으로 자세를 무너뜨리는 모습을 약 15~20초 간 촬영하여 video.mp4로 저장하는 코드

🧩 2. 동영상을 50프레임으로 분할하여 이미지로 저장

video.mp4를 OpenCV로 불러와, 등간격으로 50개의 프레임을 추출하여 frames/frame_01.jpg ~ frames/frame_50.jpg로 저장

🧩 3. 프레임 이미지에서 MediaPipe로 랜드마크 추출 후 CSV 저장

각 프레임에서 MediaPipe Pose 모델을 활용해 랜드마크를 추출

코, 눈, 어깨 좌표를 사용하여 카메라가 피사체의 왼쪽인지 오른쪽인지 자동 판단

예시 로직: 코가 왼쪽 눈보다 오른쪽에 있으면 ‘왼쪽 측면’, 그 반대면 ‘오른쪽 측면’

측정에 사용할 랜드마크는 해당 방향(LEFT_XXX 또는 RIGHT_XXX)을 선택하여 사용

CSV 저장 형식:

피사체ID (예: P1, P2, ...)

프레임 이미지 파일명

각 좌표의 x, y 값 (예: LEFT_SHOULDER_x, LEFT_SHOULDER_y, ...)

카메라 위치 (left or right)

🧩 4. 카메라 위치에 따라 선택된 좌표만 추출하여 새로운 CSV 구성

귀–어깨, 어깨–골반 계산에 필요한 한쪽 방향의 좌표만 필터링

결과적으로 CVA 계산용 핵심 좌표만 포함한 CSV를 생성

🧩 5. 위 CSV를 기반으로 CVA 계산 후 결과 저장

귀–어깨 각도 (CVA 1) 와 어깨–골반 각도 (CVA 2) 계산

벡터 간 각도 계산 방식 사용

최종 CSV 컬럼:

피사체ID

프레임 이미지 파일명

귀–어깨 각도

어깨–골반 각도

🧩 6. CVA 기준으로 10단계 등급 구간 계산

귀–어깨 각도 기준으로:

가장 큰 각도 = 1단계 (가장 바른 자세)

가장 작은 각도 = 10단계 (가장 무너진 자세)

이 사이를 균등한 9개의 구간으로 나누어 단계화

🧩 7. 각 단계에 해당하는 이미지 자동 추출

계산된 각도 구간을 기준으로

각 단계별 조건에 해당하는 프레임 이미지들을 찾아 식별 및 출력 or 별도 저장

✅ 선택적 확장 요청

결과 영상에 cv2.putText() 등으로 각도 및 등급 정보를 오버레이하여 시각화 파일 생성

전체 작업을 .py 또는 .ipynb 파일로 정리

사용자 피드백 인터페이스를 위한 좌우 반전 미러링 출력 화면 구현